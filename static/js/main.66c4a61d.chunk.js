(this["webpackJsonpcheck-mailbox"]=this["webpackJsonpcheck-mailbox"]||[]).push([[0],{50:function(e,t,a){e.exports=a(62)},55:function(e,t,a){},56:function(e,t,a){},62:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(13),l=a.n(r),i=(a(55),a(27)),c=a(20),s=(a(56),a(85)),u=a(86),g=a(87),m=a(90),d=a(89),p=a(88),f=a(35),h=a.n(f),w=a(36),E=a.n(w),b=a(37),v=a.n(b),k=Object(s.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1,textAlign:"center"}}}));function y(e){var t=e.inquiryPressed,a=e.downloadBtnClicked,n=e.loginClicked,r=e.userName,l=e.isInProgress,i=k(),c=r?"Logout":"Login";return console.log("function ButtonAppBar: "),console.log(r),o.a.createElement("div",{className:i.root},o.a.createElement(u.a,{position:"fixed"},o.a.createElement(g.a,null,o.a.createElement(p.a,{edge:"start",className:i.menuButton,color:"inherit","aria-label":"refresh",onClick:t,disabled:l},o.a.createElement(h.a,null)),o.a.createElement(p.a,{edge:"start",className:i.menuButton,color:"inherit","aria-label":"info",disabled:l},o.a.createElement(E.a,null)),o.a.createElement(d.a,{variant:"contained",color:"primary",className:i.button,onClick:n,disabled:l},c),o.a.createElement(m.a,{variant:"h6",className:i.title},"Oracle Reports"),o.a.createElement(d.a,{variant:"contained",color:"primary",className:i.button,startIcon:o.a.createElement(v.a,null),onClick:a,disabled:l},"Download"))))}var I=a(99),N=a(97),S=a(92),x=a(96),j=a(95),O=a(91),A=a(93),B=a(94),C=a(65),D=Object(s.a)((function(e){return{table:{},head:{backgroundColor:e.palette.info.main,color:e.palette.common.white,position:"sticky",top:"64px",zIndex:"10"},root:{width:"100%",display:"table",margin:"0px"}}}));function R(e){var t=e.headerCells,a=e.dataRows,n=D();return o.a.createElement(O.a,{component:C.a,className:n.root},o.a.createElement(S.a,{className:n.table,"aria-label":"customized table"},o.a.createElement(A.a,null,o.a.createElement(B.a,{key:"-1"},t.map((function(e,t){return o.a.createElement(j.a,{key:"header/"+t,className:n.head,align:e.align},e.fieldName," ")})))),o.a.createElement(x.a,null,a.map((function(e,t){return o.a.createElement(B.a,{key:"ROW/"+t},o.a.createElement(j.a,{key:t+"/1",component:"th",scope:"row"},e.reportName),o.a.createElement(j.a,{key:t+"/2",align:"left"},e.subject),o.a.createElement(j.a,{key:t+"/3",align:"left"},e.requestID),o.a.createElement(j.a,{key:t+"/4",align:"left"},e.linkString),o.a.createElement(j.a,{key:t+"/5",align:"left"},e.requestID))})))))}var q=Object(s.a)((function(e){return{appBar:{top:"auto",bottom:0,minHeight:0},toolBar:{height:"auto",minHeight:0},statusText:{fontSize:10},statusBox:{background:"#7777ff",fontSize:"12px",margin:"10px",padding:"2px 10px",display:"inline"}}}));function P(e){var t=q();return o.a.createElement(o.a.Fragment,null,o.a.createElement(u.a,{position:"fixed",color:"primary",className:t.appBar},o.a.createElement(g.a,{className:t.toolBar},o.a.createElement(m.a,{variant:"subtitle"},o.a.createElement(I.a,{className:t.statusBox},e.message1),e.message2?o.a.createElement(I.a,{className:t.statusBox},e.message2):o.a.createElement(o.a.Fragment,null)))))}var T=a(98),L=["https://script.googleapis.com/$discovery/rest?version=v1"],z=[{fieldName:"Report Name",align:"left"},{fieldName:"Subject",align:"left"},{fieldName:"Request ID",align:"left"},{fieldName:"Link",align:"left"},{fieldName:"ThreadID",align:"left"}],J="InitName",U=function(e){var t=Object(n.useState)(J),a=Object(c.a)(t,2),r=a[0],l=a[1];return console.log(r),o.a.createElement(M,{appUName:r,setAppUName:l})};function M(e){var t=e.appUName,a=e.setAppUName;if(console.log("function app Started"),!document.getElementById("gapi_script")){var r=document.createElement("script");r.src="https://apis.google.com/js/client.js",r.setAttribute("id","gapi_script"),r.setAttribute("async",""),r.setAttribute("defer",""),r.onload=function(){window.gapi.load("client:auth2",v)},document.body.appendChild(r)}var l=Object(n.useState)([]),s=Object(c.a)(l,2),u=s[0],g=s[1],m=Object(n.useState)(!1),d=Object(c.a)(m,2),p=d[0],f=d[1],h=Object(n.useState)(null),w=Object(c.a)(h,2),E=w[0],b=w[1];function v(){window.gapi.client.init({apiKey:"AIzaSyC0cQTER_N-0dL0zEWkQXuo1QMh0g2dwN8",clientId:"892957647558-082vpajq1c13c12fqo3a63fqrd3uulqr.apps.googleusercontent.com",discoveryDocs:L,scope:"https://www.googleapis.com/auth/script.projects https://www.googleapis.com/auth/drive https://mail.google.com/"}).then((function(){console.log("gapi.client.init went OK"),window.gapi.auth2.getAuthInstance().isSignedIn.listen(k),k(window.gapi.auth2.getAuthInstance().isSignedIn.get())}),(function(e){console.log("gapi.client.init went wrong:"),console.log(e)}))}var k=function(e){if(console.log("function updateSigninStatus:"),console.log(e),e){var t=window.gapi.auth2.getAuthInstance().currentUser.get().getBasicProfile();console.log(t.getName()),J=t.getName()}else J=null;a(J),console.log(J)};return o.a.createElement(o.a.Fragment,null,o.a.createElement(N.a,null),o.a.createElement(y,{inquiryPressed:function(e){console.log("Refresh Started!"),b("Download in progress"),f(!0),window.gapi.client.script.scripts.run({scriptId:"1_LCQKiOadsTyDbwJIGwN0jwyS9xJ3z-wDq_Pgk2P-wtpbJGX1EObhntl",resource:{function:"lookupEmails",parameters:["label:orareport"],devMode:!0}}).then((function(e){var t=e.result;if(t.error&&t.error.status)console.log("Error calling API:"),console.log(t);else if(t.error){var a=t.error.details[0];if(console.log(t.error),console.log("Script error message: "+a.errorMessage),a.scriptStackTraceElements){console.log("Script error stacktrace:");var n,o=Object(i.a)(a.scriptStackTraceElements);try{for(o.s();!(n=o.n()).done;){var r=n.value;console.log(r)}}catch(l){o.e(l)}finally{o.f()}}}else console.log(e.result.response.result),g(e.result.response.result),b("Download is Ready - "+e.result.response.result.length+" report(s) found");f(!1)}))},downloadBtnClicked:function(e){console.log("buttonClicked function started"),b("Textfile download in progress"),f(!0),window.gapi.client.script.scripts.run({scriptId:"1_LCQKiOadsTyDbwJIGwN0jwyS9xJ3z-wDq_Pgk2P-wtpbJGX1EObhntl",resource:{function:"emailLabelChange",parameters:[u.map((function(e){return e.threadID}))],devMode:!0}}).then((function(e){var t=e.result;if(t.error&&t.error.status)console.log("Error calling API:"),console.log(t);else if(t.error){var a=t.error.details[0];if(console.log(t.error),console.log("Script error message: "+a.errorMessage),a.scriptStackTraceElements){console.log("Script error stacktrace:");var n,o=Object(i.a)(a.scriptStackTraceElements);try{for(o.s();!(n=o.n()).done;){var r=n.value;console.log(r)}}catch(l){o.e(l)}finally{o.f()}}}else console.log(e.result.response.result),b("Text File downloaded - "+e.result.response.result),g([]);f(!1)}));var t,a="Request ID|Subject|Report Name|Link\r\n",n=Object(i.a)(u);try{for(n.s();!(t=n.n()).done;){var o=t.value;a+=o.requestID+"|"+o.subject+"|"+o.reportName+"|"+o.linkString+"\r\n"}}catch(r){n.e(r)}finally{n.f()}!function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"egy meg egy\r\nkett\u0151\nh\xe1rom";console.log("downloadfile2 function started");var a=document.createElement("a"),n=new Blob(["\ufeff",t],{type:"text/plain;charset=ISO-8859-2"});if(a.setAttribute("href",window.URL.createObjectURL(n)),a.setAttribute("download",e),document.createEvent){var o=document.createEvent("MouseEvents");o.initEvent("click",!0,!0),a.dispatchEvent(o)}else a.click()}("emailDetails.txt",a),e.stopPropagation()},loginClicked:function(e){console.log(window.gapi.auth2.getAuthInstance().isSignedIn.get()),window.gapi.auth2.getAuthInstance().isSignedIn.get()?window.gapi.auth2.getAuthInstance().signOut():window.gapi.auth2.getAuthInstance().signIn(),e.stopPropagation()},userName:t,isInProgress:p}),p?o.a.createElement("div",{style:{position:"fixed",left:"50%",top:"50%",zIndex:100,display:"block"}},o.a.createElement(T.a,null)):o.a.createElement(o.a.Fragment,null),o.a.createElement(I.a,{m:"20px",mt:"80px"},o.a.createElement(R,{headerCells:z,dataRows:u})),o.a.createElement(P,{message1:"Username: "+t,message2:E}))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(U,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[50,1,2]]]);
//# sourceMappingURL=main.66c4a61d.chunk.js.map